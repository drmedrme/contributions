<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="wiz_capture_pic" model="ir.ui.view">
        <field name="name">wiz.capture.pic.form</field>
        <field name="model">wiz.capture.pic</field>
        <field name="arch" type="xml">
            <form>
                <style type="text/css">
                    body { font-family: Helvetica, sans-serif; }
                    h2, h3 { margin-top:0; }
                    form { margin-top: 15px; }
                    form input { margin-right: 15px; }
                    #results { float:right; margin:20px; padding:20px; border:1px solid; background:#ccc; }
                </style>
                <div id="results">Your captured image will appear here...</div>
                <div id="my_camera"></div>

                <!-- Configure a few settings and attach camera -->
                <script language="JavaScript">
                    Webcam.set({
                        width: 320,
                        height: 240,
                        image_format: 'png',
                        jpeg_quality: 90
                    });
                    Webcam.attach( '#my_camera' );
                </script>

                <!-- A button for taking snaps -->
                    <div id="pre_take_buttons">
                        <input type="button" value="Take Snapshot" onClick="preview_snapshot()"/>
                    </div>
                    <div id="post_take_buttons" style="display:none">
                        <input type="button" value="Take Another" onClick="cancel_preview()"/>
                        <input type="button" value="Save Photo" onClick="save_photo()" style="font-weight:bold;"/>
                    </div>

                <!-- Code to handle taking the snapshot and displaying it locally -->
                <script language="JavaScript">
                    function preview_snapshot() {
                        // freeze camera so user can preview pic
                        Webcam.freeze();

                        // swap button sets
                        document.getElementById('pre_take_buttons').style.display = 'none';
                        document.getElementById('post_take_buttons').style.display = '';
                    }

                    function cancel_preview() {
                        // cancel preview freeze and return to live camera feed
                        Webcam.unfreeze();

                        // swap buttons back
                        document.getElementById('pre_take_buttons').style.display = '';
                        document.getElementById('post_take_buttons').style.display = 'none';
                    }

                    function save_photo() {
                        // actually snap photo (from preview freeze) and display it
                        Webcam.snap(function(data_uri) {
                            // display results in page
                            document.getElementById('results').innerHTML = 
                                '<h2>Here is your image:</h2>' + 
                                '<img src="'+data_uri+'"/>' + 
                                '<input id="img_result" value="'+data_uri+'" class="hidden"/>';
                            // swap buttons back
                            document.getElementById('pre_take_buttons').style.display = '';
                            document.getElementById('post_take_buttons').style.display = 'none';
                        });
                    }
                </script>
            </form>
        </field>
    </record>

</odoo>
